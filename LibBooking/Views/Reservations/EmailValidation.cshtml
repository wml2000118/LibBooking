@using System.Text.Json

@model LibBooking.Models.EmailValidationViewModel

@{
    ViewData["Title"] = "Email Validation";
}

<h1>Email Validation</h1>

@if (!string.IsNullOrEmpty(ViewBag.Message))
{
    <div class="alert @(ViewBag.Message.Contains("成功") ? "alert-success" : "alert-danger")">
        @ViewBag.Message
    </div>
}

<div class="container">
    <form asp-action="EmailValidation" method="post">
        <input type="hidden" id="id" name="ID" value="@Model.ID" />
        <div class="form-group">
            <label for="room">Room:</label>
            <input type="text" id="room" name="room" value="@Model.Room" class="form-control" readonly />
        </div>
        <div class="form-group">
            <label for="time">Time:</label>
            <input type="number" id="time" name="Time" value="@Model.Time" class="form-control" readonly />
        </div>
        <div class="form-group">
            <label for="date">Date:</label>
            <input type="text" id="date" name="date" value="@Model.Date.ToString("yyyy-MM-dd")" class="form-control" readonly />
        </div>
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" value="@Model.Email" class="form-control" required />
        </div>
        <button type="submit" class="btn btn-primary" id="submitBtn">Submit</button>
    </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <!-- 引入 SweetAlert2 -->

<script>
    // 检查 TempData 中是否有消息并显示弹窗
    document.addEventListener("DOMContentLoaded", function () {
        // 使用 JsonSerializer.Serialize 来正确处理消息内容
        const message = @Html.Raw(JsonSerializer.Serialize(TempData["Message"]));
        const messageType = '@TempData["MessageType"]';

        if (messageType) {
            // 使用 SweetAlert2 显示成功或错误消息
            if (messageType === "success") {
                Swal.fire({
                    icon: 'success',
                    title: 'Success',  // 只显示“Success”
                    showConfirmButton: true,
                    timer: 3000
                });
            } else if (messageType === "error") {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',  // 只显示“Error”
                    showConfirmButton: true,
                    timer: 3000
                });
            }
        }
    });
</script>


