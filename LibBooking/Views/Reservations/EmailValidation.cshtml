@model LibBooking.Models.EmailValidationViewModel

@{
    ViewData["Title"] = "Email Validation";
}

<h1>Email Validation</h1>

@if (!string.IsNullOrEmpty(ViewBag.Message))
{
    <div class="alert @(ViewBag.Message.Contains("成功") ? "alert-success" : "alert-danger")">
        @ViewBag.Message
    </div>
}

<div class="container">
    <form asp-action="EmailValidation" method="post">
        <input type="hidden" id="id" name="ID" value="@Model.ID" />
        <div class="form-group">
            <label for="room">Room:</label>
            <input type="text" id="room" name="room" value="@Model.Room" class="form-control" readonly />
        </div>
        <div class="form-group">
            <label for="time">Time:</label>
            <input type="number" id="time" name="Time" value="@Model.Time" class="form-control" readonly />
        </div>


        <div class="form-group">
            <label for="date">Date:</label>
            <input type="text" id="date" name="date" value="@Model.Date.ToString("yyyy-MM-dd")" class="form-control" readonly />
        </div>
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" value="@Model.Email" class="form-control" required />
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>
@section Scripts {
    <script>
        document.getElementById('submitBtn').addEventListener('click', function (event) {
            event.preventDefault(); // 防止默认的表单提交

            var formData = new FormData();
            formData.append('ID', document.getElementById('id').value);
            formData.append('room', document.getElementById('room').value);
            formData.append('time', document.getElementById('time').value);
            formData.append('date', document.getElementById('date').value);
            formData.append('email', document.getElementById('email').value);

            fetch('/api/Reservations/email-validation', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message); // 显示来自服务器的消息
                })
                .catch(error => console.error('Error:', error));
        });
    </script>
}
